<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Yo Store - –ü–∞–Ω–µ–ª—å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞</title>
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #2c3e50 0%, #34495e 100%);
            min-height: 100vh;
            color: #fff;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }
        
        .header {
            text-align: center;
            margin-bottom: 30px;
        }
        
        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            color: #f39c12;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
        }
        
        .logo {
            width: 50px;
            height: 50px;
            border-radius: 10px;
            object-fit: cover;
        }
        
        .admin-nav {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 20px;
            display: flex;
            gap: 10px;
            justify-content: center;
            flex-wrap: wrap;
        }
        
        .admin-nav button {
            padding: 10px 20px;
            border: none;
            border-radius: 8px;
            background: #3498db;
            color: white;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 14px;
        }
        
        .admin-nav button:hover {
            background: #2980b9;
            transform: translateY(-2px);
        }
        
        .admin-nav button.active {
            background: #e74c3c;
        }
        
        .admin-content {
            display: none;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 10px;
            padding: 20px;
            color: #333;
        }
        
        .admin-content.active {
            display: block;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: 600;
        }
        
        .form-group input, .form-group select, .form-group textarea {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 14px;
        }
        
        .form-group textarea {
            resize: vertical;
            min-height: 100px;
        }
        
        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            transition: all 0.3s ease;
        }
        
        .btn-primary {
            background: #3498db;
            color: white;
        }
        
        .btn-primary:hover {
            background: #2980b9;
        }
        
        .btn-success {
            background: #27ae60;
            color: white;
        }
        
        .btn-success:hover {
            background: #229954;
        }
        
        .btn-danger {
            background: #e74c3c;
            color: white;
        }
        
        .btn-danger:hover {
            background: #c0392b;
        }
        
        .product-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }
        
        .product-card {
            border: 1px solid #ddd;
            border-radius: 8px;
            padding: 15px;
            background: white;
        }
        
        .product-card h3 {
            margin-bottom: 10px;
            color: #2c3e50;
        }
        
        .product-card p {
            margin-bottom: 5px;
            color: #666;
        }
        
        .status-success {
            color: #27ae60;
            font-weight: 600;
        }
        
        .status-warning {
            color: #f39c12;
            font-weight: 600;
        }
        
        .status-error {
            color: #e74c3c;
            font-weight: 600;
        }
        
        @media (max-width: 768px) {
            .container {
                padding: 10px;
            }
            
            .header h1 {
                font-size: 2rem;
            }
            
            .admin-nav {
                flex-direction: column;
            }
            
            .product-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>
                üõ†Ô∏è Yo Store Admin
                <img src="/static/images/logo.jpg" alt="Yo Store" class="logo">
            </h1>
            <p style="color: #bdc3c7;">–ü–∞–Ω–µ–ª—å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ –º–∞–≥–∞–∑–∏–Ω–∞ —ç–ª–µ–∫—Ç—Ä–æ–Ω–∏–∫–∏</p>
        </div>
        
        <div class="admin-nav">
            <button onclick="showSection('dashboard')" class="active">–û–±–∑–æ—Ä</button>
            <button onclick="showSection('products')">–¢–æ–≤–∞—Ä—ã</button>
            <button onclick="showSection('categories')">–ö–∞—Ç–µ–≥–æ—Ä–∏–∏</button>
            <button onclick="showSection('prices')">–¶–µ–Ω—ã</button>
            <button onclick="showSection('upload')">–ó–∞–≥—Ä—É–∑–∫–∞ Excel</button>
            <button onclick="showSection('export')">–≠–∫—Å–ø–æ—Ä—Ç</button>
            <button onclick="showSection('manual')">–†—É—á–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ</button>
        </div>
        
        <!-- Dashboard Section -->
        <div id="dashboard" class="admin-content active">
            <h2>üìä –û–±–∑–æ—Ä –º–∞–≥–∞–∑–∏–Ω–∞</h2>
            <div id="stats-content">
                <p style="color: #666;">–ó–∞–≥—Ä—É–∑–∫–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏...</p>
            </div>
        </div>
        
        <!-- Products Section -->
        <div id="products" class="admin-content">
            <h2>üì¶ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞–º–∏</h2>
            <div class="form-group" style="display: flex; gap: 10px; flex-wrap: wrap;">
                <button onclick="showAddProductForm()" class="btn btn-success">‚ûï –î–æ–±–∞–≤–∏—Ç—å —Ç–æ–≤–∞—Ä</button>
                <button onclick="downloadCurrentProducts()" class="btn btn-primary">üì• –°–∫–∞—á–∞—Ç—å —Ç–µ–∫—É—â–∏–µ —Ç–æ–≤–∞—Ä—ã</button>
                <button onclick="showUploadProductsForm()" class="btn btn-warning">üì§ –ó–∞–≥—Ä—É–∑–∏—Ç—å –∏ –æ–±–Ω–æ–≤–∏—Ç—å —Ç–æ–≤–∞—Ä—ã</button>
            </div>
            <div id="products-content">
                <p style="color: #666;">–ó–∞–≥—Ä—É–∑–∫–∞ —Ç–æ–≤–∞—Ä–æ–≤...</p>
            </div>
        </div>
        
        <!-- Categories Section -->
        <div id="categories" class="admin-content">
            <h2>üìÇ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º–∏</h2>
            <div class="form-group">
                <button onclick="showAddCategoryForm()" class="btn btn-success">–î–æ–±–∞–≤–∏—Ç—å –∫–∞—Ç–µ–≥–æ—Ä–∏—é</button>
            </div>
            <div id="categories-content">
                <p style="color: #666;">–ó–∞–≥—Ä—É–∑–∫–∞ –∫–∞—Ç–µ–≥–æ—Ä–∏–π...</p>
            </div>
        </div>
        
        <!-- Prices Section -->
        <div id="prices" class="admin-content">
            <h2>üí∞ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ü–µ–Ω–∞–º–∏</h2>
            
            <div class="form-group">
                <h3>üìä –ú–∞—Å—Å–æ–≤–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —á–µ—Ä–µ–∑ Excel</h3>
                <div style="background: #f8f9fa; padding: 15px; border-radius: 8px; margin-bottom: 15px;">
                    <p><strong>–§–æ—Ä–º–∞—Ç —Ñ–∞–π–ª–∞:</strong> SKU - –ù–æ–≤–∞—è —Ü–µ–Ω–∞ - –°—Ç–∞—Ä–∞—è —Ü–µ–Ω–∞</p>
                    <p><strong>–ü—Ä–∏–º–µ—Ä:</strong></p>
                    <pre style="background: white; padding: 10px; border-radius: 5px;">
SKU              | –ù–æ–≤–∞—è —Ü–µ–Ω–∞ | –°—Ç–∞—Ä–∞—è —Ü–µ–Ω–∞
APPIP16          | 59990      | 69990
APPIP16PRO       | 89990      | 99990
IPHONE17PROMAX   | 129990     | 149990
                    </pre>
                </div>
                <div style="display: flex; gap: 10px; align-items: center;">
                    <a href="/download-price-template" class="btn btn-primary">üì• –°–∫–∞—á–∞—Ç—å —à–∞–±–ª–æ–Ω Excel</a>
                    <span style="color: #666;">–∏–ª–∏</span>
                </div>
            </div>
            
            <div class="form-group">
                <label for="price-excel-file">–í—ã–±–µ—Ä–∏—Ç–µ —Ñ–∞–π–ª Excel —Å —Ü–µ–Ω–∞–º–∏:</label>
                <input type="file" id="price-excel-file" accept=".xlsx,.xls">
            </div>
            <button onclick="uploadPriceExcel()" class="btn btn-success">üì§ –û–±–Ω–æ–≤–∏—Ç—å —Ü–µ–Ω—ã –∏–∑ Excel</button>
            <div id="price-excel-result"></div>
            
            <hr style="margin: 30px 0;">
            
            <div class="form-group">
                <h3>‚úèÔ∏è –†—É—á–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –æ–¥–Ω–æ–π —Ü–µ–Ω—ã</h3>
                <label for="price-sku">–í—ã–±–µ—Ä–∏—Ç–µ —Ç–æ–≤–∞—Ä:</label>
                <select id="price-sku">
                    <option value="">–í—ã–±–µ—Ä–∏—Ç–µ —Ç–æ–≤–∞—Ä...</option>
                </select>
            </div>
            <div class="form-group">
                <label for="new-price">–ù–æ–≤–∞—è —Ü–µ–Ω–∞ (—Ä—É–±.):</label>
                <input type="number" id="new-price" step="0.01" placeholder="0.00">
            </div>
            <div class="form-group">
                <label for="old-price">–°—Ç–∞—Ä–∞—è —Ü–µ–Ω–∞ (—Ä—É–±.):</label>
                <input type="number" id="old-price" step="0.01" placeholder="0.00">
            </div>
            <button onclick="updatePrice()" class="btn btn-primary">–û–±–Ω–æ–≤–∏—Ç—å —Ü–µ–Ω—É</button>
            <div id="price-result"></div>
        </div>
        
        <!-- Upload Section -->
        <div id="upload" class="admin-content">
            <h2>üì§ –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –∏–∑ Excel</h2>
            
            <div class="form-group">
                <h3>üìã –®–∞–±–ª–æ–Ω—ã –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏</h3>
                <p>–°–∫–∞—á–∞–π—Ç–µ –≥–æ—Ç–æ–≤—ã–µ —à–∞–±–ª–æ–Ω—ã Excel –¥–ª—è –º–∞—Å—Å–æ–≤–æ–≥–æ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —Ç–æ–≤–∞—Ä–æ–≤ –∏–ª–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Ü–µ–Ω:</p>
                <div style="display: flex; gap: 15px; margin: 15px 0;">
                    <a href="/api/excel/template/products" class="btn btn-primary">üì• –®–∞–±–ª–æ–Ω —Ç–æ–≤–∞—Ä–æ–≤</a>
                    <a href="/download-price-template" class="btn btn-success">üì• –®–∞–±–ª–æ–Ω —Ü–µ–Ω</a>
                </div>
                <div style="background: #f8f9fa; padding: 15px; border-radius: 8px; margin: 15px 0;">
                    <h4>üí° –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è:</h4>
                    <ol style="margin: 10px 0; padding-left: 20px;">
                        <li><strong>–°–∫–∞—á–∞–π—Ç–µ —à–∞–±–ª–æ–Ω</strong> - –≤—ã–±–µ—Ä–∏—Ç–µ –Ω—É–∂–Ω—ã–π —Ç–∏–ø (—Ç–æ–≤–∞—Ä—ã –∏–ª–∏ —Ü–µ–Ω—ã)</li>
                        <li><strong>–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –¥–∞–Ω–Ω—ã–µ</strong> - —Å–ª–µ–¥—É–π—Ç–µ —Ñ–æ—Ä–º–∞—Ç—É –≤ —à–∞–±–ª–æ–Ω–µ</li>
                        <li><strong>–ó–∞–≥—Ä—É–∑–∏—Ç–µ —Ñ–∞–π–ª</strong> - –≤—ã–±–µ—Ä–∏—Ç–µ –∑–∞–ø–æ–ª–Ω–µ–Ω–Ω—ã–π —Ñ–∞–π–ª –∏ –Ω–∞–∂–º–∏—Ç–µ "–ó–∞–≥—Ä—É–∑–∏—Ç—å"</li>
                        <li><strong>–ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç</strong> - —Å–∏—Å—Ç–µ–º–∞ –ø–æ–∫–∞–∂–µ—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –æ–±—Ä–∞–±–æ—Ç–∫–∏</li>
                    </ol>
                </div>
            </div>
            
            <div class="form-group">
                <h3>üìä –ó–∞–≥—Ä—É–∑–∫–∞ —Ç–æ–≤–∞—Ä–æ–≤</h3>
                <p>–ó–∞–≥—Ä—É–∑–∏—Ç–µ Excel —Ñ–∞–π–ª —Å —Ç–æ–≤–∞—Ä–∞–º–∏ –¥–ª—è –º–∞—Å—Å–æ–≤–æ–≥–æ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –≤ –∫–∞—Ç–∞–ª–æ–≥:</p>
                <div class="form-group">
                    <label for="excel-file">–í—ã–±–µ—Ä–∏—Ç–µ —Ñ–∞–π–ª Excel —Å —Ç–æ–≤–∞—Ä–∞–º–∏:</label>
                    <input type="file" id="excel-file" accept=".xlsx,.xls">
                </div>
                <button onclick="uploadExcel()" class="btn btn-primary">üì§ –ó–∞–≥—Ä—É–∑–∏—Ç—å —Ç–æ–≤–∞—Ä—ã</button>
                <div id="upload-result"></div>
            </div>
            
            <div class="form-group">
                <h3>üí∞ –ó–∞–≥—Ä—É–∑–∫–∞ —Ü–µ–Ω</h3>
                <p>–ó–∞–≥—Ä—É–∑–∏—Ç–µ Excel —Ñ–∞–π–ª —Å —Ü–µ–Ω–∞–º–∏ –¥–ª—è –º–∞—Å—Å–æ–≤–æ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è:</p>
                <div class="form-group">
                    <label for="price-excel-file">–í—ã–±–µ—Ä–∏—Ç–µ —Ñ–∞–π–ª Excel —Å —Ü–µ–Ω–∞–º–∏:</label>
                    <input type="file" id="price-excel-file" accept=".xlsx,.xls">
                </div>
                <button onclick="uploadPriceExcel()" class="btn btn-success">üì§ –û–±–Ω–æ–≤–∏—Ç—å —Ü–µ–Ω—ã</button>
                <div id="price-excel-result"></div>
            </div>
            
            <div class="form-group">
                <h3>üñºÔ∏è –ó–∞–≥—Ä—É–∑–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π</h3>
                <p>–ó–∞–≥—Ä—É–∑–∏—Ç–µ Excel —Ñ–∞–π–ª —Å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º–∏ –¥–ª—è —Ç–æ–≤–∞—Ä–æ–≤ (–ø–æ –º–æ–¥–µ–ª–∏ –∏ —Ü–≤–µ—Ç—É):</p>
                <div class="form-group">
                    <label for="images-excel-file">–í—ã–±–µ—Ä–∏—Ç–µ —Ñ–∞–π–ª Excel —Å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º–∏:</label>
                    <input type="file" id="images-excel-file" accept=".xlsx,.xls">
                </div>
                <button onclick="uploadImagesExcel()" class="btn btn-info">üì§ –ó–∞–≥—Ä—É–∑–∏—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è</button>
                <div id="images-excel-result"></div>
            </div>
        </div>
        
        <!-- Export Section -->
        <div id="export" class="admin-content">
            <h2>üì§ –≠–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö</h2>
            
            <div class="form-group">
                <h3>üìä –ü–æ–ª–Ω—ã–π –∞—Å—Å–æ—Ä—Ç–∏–º–µ–Ω—Ç</h3>
                <p>–°–∫–∞—á–∞—Ç—å –≤—Å—é –±–∞–∑—É —Ç–æ–≤–∞—Ä–æ–≤ —Å–æ –≤—Å–µ–º–∏ –∫–æ–ª–æ–Ω–∫–∞–º–∏ (ID, SKU, –Ω–∞–∑–≤–∞–Ω–∏—è, –æ–ø–∏—Å–∞–Ω–∏—è, —Ü–µ–Ω—ã, —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏, –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –∏ —Ç.–¥.)</p>
                <a href="/export-products" class="btn btn-primary">üì• –°–∫–∞—á–∞—Ç—å –≤–µ—Å—å –∞—Å—Å–æ—Ä—Ç–∏–º–µ–Ω—Ç</a>
            </div>
            
            <div class="form-group">
                <h3>üí∞ –í—Å–µ —Ü–µ–Ω—ã</h3>
                <p>–°–∫–∞—á–∞—Ç—å –≤—Å–µ —Ü–µ–Ω—ã —Ç–æ–≤–∞—Ä–æ–≤ –≤ —É–¥–æ–±–Ω–æ–º —Ñ–æ—Ä–º–∞—Ç–µ –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ (SKU, –Ω–∞–∑–≤–∞–Ω–∏—è, —Ç–µ–∫—É—â–∏–µ –∏ —Å—Ç–∞—Ä—ã–µ —Ü–µ–Ω—ã, —Å–∫–∏–¥–∫–∏)</p>
                <a href="/export-prices" class="btn btn-success">üì• –°–∫–∞—á–∞—Ç—å –≤—Å–µ —Ü–µ–Ω—ã</a>
            </div>
            
            <div class="form-group">
                <h3>üìã –®–∞–±–ª–æ–Ω—ã –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è</h3>
                <p>–°–∫–∞—á–∞—Ç—å –≥–æ—Ç–æ–≤—ã–µ —à–∞–±–ª–æ–Ω—ã –¥–ª—è –º–∞—Å—Å–æ–≤–æ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö</p>
                <div style="display: flex; gap: 10px; margin-top: 10px;">
                    <a href="/download-price-template" class="btn btn-primary">üì• –®–∞–±–ª–æ–Ω —Ü–µ–Ω</a>
                    <a href="/api/excel/template/products" class="btn btn-primary">üì• –®–∞–±–ª–æ–Ω —Ç–æ–≤–∞—Ä–æ–≤</a>
                </div>
            </div>
            
            <div class="form-group" style="background: #f8f9fa; padding: 15px; border-radius: 8px;">
                <h4>üí° –ü–æ–ª–µ–∑–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è:</h4>
                <ul style="margin: 10px 0; padding-left: 20px;">
                    <li><strong>–ü–æ–ª–Ω—ã–π –∞—Å—Å–æ—Ä—Ç–∏–º–µ–Ω—Ç</strong> - —Å–æ–¥–µ—Ä–∂–∏—Ç –≤—Å–µ –¥–∞–Ω–Ω—ã–µ –æ —Ç–æ–≤–∞—Ä–∞—Ö –¥–ª—è –ø–æ–ª–Ω–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞</li>
                    <li><strong>–í—Å–µ —Ü–µ–Ω—ã</strong> - –æ–ø—Ç–∏–º–∞–ª–µ–Ω –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å —Ü–µ–Ω–æ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ–º –∏ –∞–Ω–∞–ª–∏—Ç–∏–∫–æ–π</li>
                    <li><strong>–®–∞–±–ª–æ–Ω—ã</strong> - –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –¥–ª—è –º–∞—Å—Å–æ–≤–æ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö</li>
                </ul>
            </div>
        </div>
        
        <!-- Manual Management Section -->
        <div id="manual" class="admin-content">
            <h2>üîß –†—É—á–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ü–µ–Ω–∞–º–∏</h2>
            <div class="form-group">
                <button onclick="openManualPriceManager()" class="btn btn-primary">–û—Ç–∫—Ä—ã—Ç—å –º–µ–Ω–µ–¥–∂–µ—Ä —Ü–µ–Ω</button>
            </div>
            <div id="manual-content"></div>
        </div>
    </div>

    <script>
        function showSection(sectionId) {
            // Hide all sections
            document.querySelectorAll('.admin-content').forEach(section => {
                section.classList.remove('active');
            });
            
            // Remove active class from all buttons
            document.querySelectorAll('.admin-nav button').forEach(buttons => {
                buttons.classList.remove('active');
            });
            
            // Show selected section
            document.getElementById(sectionId).classList.add('active');
            
            // Add active class to clicked button
            event.target.classList.add('active');
            
            // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –ø—Ä–∏ –ø–µ—Ä–µ—Ö–æ–¥–µ –≤ —Å–µ–∫—Ü–∏–∏
            if (sectionId === 'products') {
                loadProducts();
            } else if (sectionId === 'categories') {
                loadCategories();
            } else if (sectionId === 'dashboard') {
                loadStats();
            }
        }
        
        function loadStats() {
            const content = document.getElementById('stats-content');
            content.innerHTML = '<p>–ó–∞–≥—Ä—É–∑–∫–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏...</p>';
            
            // –ó–∞–≥—Ä—É–∂–∞–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ
               Promise.all([
                   fetch('/categories').then(r => r.json()),
                   fetch('/all-products').then(r => r.json()),
                   fetch('/api/prices/current').then(r => r.json())
               ])
            .then(([categories, products, prices]) => {
                // –ü–æ–¥—Å—á–∏—Ç—ã–≤–∞–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
                const totalProducts = products.length;
                const totalCategories = categories.length;
                const totalPrices = prices.length;
                const productsWithSKU = products.filter(p => p.sku).length;
                const productsWithoutSKU = products.filter(p => !p.sku).length;
                
                // –ì—Ä—É–ø–ø–∏—Ä—É–µ–º –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º
                const categoryStats = {};
                products.forEach(product => {
                    const cat = product.level_0 || '–ë–µ–∑ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏';
                    categoryStats[cat] = (categoryStats[cat] || 0) + 1;
                });
                
                let categoryHtml = '';
                Object.entries(categoryStats).forEach(([cat, count]) => {
                    categoryHtml += `<p><strong>${cat}:</strong> ${count} —Ç–æ–≤–∞—Ä–æ–≤</p>`;
                });
                
                content.innerHTML = `
                    <div class="product-card">
                        <h3>üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –º–∞–≥–∞–∑–∏–Ω–∞</h3>
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                            <div>
                                <h4>–û–±—â–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</h4>
                                <p><strong>–í—Å–µ–≥–æ —Ç–æ–≤–∞—Ä–æ–≤:</strong> ${totalProducts}</p>
                                <p><strong>–° SKU:</strong> ${productsWithSKU}</p>
                                <p><strong>–ë–µ–∑ SKU (–æ–±—â–∏–µ –∫–∞—Ä—Ç–æ—á–∫–∏):</strong> ${productsWithoutSKU}</p>
                                <p><strong>–ö–∞—Ç–µ–≥–æ—Ä–∏–π:</strong> ${totalCategories}</p>
                                <p><strong>–¶–µ–Ω:</strong> ${totalPrices}</p>
                            </div>
                            <div>
                                <h4>–ü–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º</h4>
                                ${categoryHtml}
                            </div>
                        </div>
                        <p style="margin-top: 15px;"><strong>–°—Ç–∞—Ç—É—Å:</strong> <span class="status-success">‚úÖ –°–∏—Å—Ç–µ–º–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ</span></p>
                        <p><strong>–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ:</strong> ${new Date().toLocaleString('ru-RU')}</p>
                    </div>
                `;
            })
            .catch(error => {
                content.innerHTML = `<p class="status-error">‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏: ${error.message}</p>`;
            });
        }
        
        function loadProducts() {
            const content = document.getElementById('products-content');
            content.innerHTML = '<p>–ó–∞–≥—Ä—É–∑–∫–∞ —Ç–æ–≤–∞—Ä–æ–≤...</p>';
            
               console.log('üîÑ –ó–∞–≥—Ä—É–∂–∞–µ–º —Ç–æ–≤–∞—Ä—ã —Å limit=1000 –≤ admin —Ä–µ–∂–∏–º–µ...');
               fetch('/all-products')
                .then(response => response.json())
                .then(products => {
                    let html = `<div style="margin-bottom: 20px; padding: 15px; background: #f8f9fa; border-radius: 8px;">
                        <h4>üìä –ó–∞–≥—Ä—É–∂–µ–Ω–æ —Ç–æ–≤–∞—Ä–æ–≤: ${products.length}</h4>
                        <p><strong>–° SKU:</strong> ${products.filter(p => p.sku).length}</p>
                        <p><strong>–ë–µ–∑ SKU:</strong> ${products.filter(p => !p.sku).length}</p>
                    </div>`;
                    html += `<div class="product-grid">`;
                    products.forEach(product => {
                        html += `
                            <div class="product-card">
                                <h3>${product.name}</h3>
                                <p><strong>ID:</strong> ${product.id}</p>
                                <p><strong>SKU:</strong> ${product.sku || '–ù–µ—Ç SKU'}</p>
                                <p><strong>–ë—Ä–µ–Ω–¥:</strong> ${product.brand}</p>
                                <p><strong>–ú–æ–¥–µ–ª—å:</strong> ${product.model}</p>
                                <p><strong>–ö–∞—Ç–µ–≥–æ—Ä–∏—è:</strong> ${product.level_0 || '–ù–µ —É–∫–∞–∑–∞–Ω–∞'}</p>
                                <p><strong>–°–µ—Ä–∏—è:</strong> ${product.level_1 || '–ù–µ —É–∫–∞–∑–∞–Ω–∞'}</p>
                                <p><strong>–ú–æ–¥–µ–ª—å:</strong> ${product.level_2 || '–ù–µ —É–∫–∞–∑–∞–Ω–∞'}</p>
                                ${product.color ? `<p><strong>–¶–≤–µ—Ç:</strong> ${product.color}</p>` : ''}
                                ${product.disk ? `<p><strong>–ü–∞–º—è—Ç—å:</strong> ${product.disk}</p>` : ''}
                                ${product.sim_config ? `<p><strong>SIM:</strong> ${product.sim_config}</p>` : ''}
                                <p><strong>–¶–µ–Ω–∞:</strong> ${product.price} ${product.currency}</p>
                                <p><strong>–î–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å:</strong> ${product.is_available ? '‚úÖ –í –Ω–∞–ª–∏—á–∏–∏' : '‚ùå –ù–µ—Ç –≤ –Ω–∞–ª–∏—á–∏–∏'}</p>
                                <div style="margin-top: 15px; display: flex; gap: 10px;">
                                    <button onclick="showEditProductForm(${product.id})" class="btn btn-primary" style="flex: 1; padding: 8px 16px;">
                                        ‚úèÔ∏è –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å
                                    </button>
                                    <button onclick="deleteProduct(${product.id}, '${product.name}')" class="btn btn-danger" style="flex: 1; padding: 8px 16px;">
                                        üóëÔ∏è –£–¥–∞–ª–∏—Ç—å
                                    </button>
                                </div>
                            </div>
                        `;
                    });
                    html += `</div>`;
                    content.innerHTML = html;
                })
                .catch(error => {
                    content.innerHTML = `<p class="status-error">‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Ç–æ–≤–∞—Ä–æ–≤: ${error.message}</p>`;
                });
        }
        
        function showAddProductForm() {
            const content = document.getElementById('products-content');
            content.innerHTML = `
                <div class="product-card">
                    <h3>‚ûï –î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–π —Ç–æ–≤–∞—Ä</h3>
                    
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 20px;">
                        <div>
                            <h4>üìã –û—Å–Ω–æ–≤–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</h4>
                            <div class="form-group">
                                <label for="product-name">–ù–∞–∑–≤–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞ *:</label>
                                <input type="text" id="product-name" placeholder="iPhone 16 Pro" required>
                            </div>
                            <div class="form-group">
                                <label for="product-brand">–ë—Ä–µ–Ω–¥ *:</label>
                                <select id="product-brand" required>
                                    <option value="">–í—ã–±–µ—Ä–∏—Ç–µ –±—Ä–µ–Ω–¥...</option>
                                    <option value="Apple">Apple</option>
                                    <option value="Samsung">Samsung</option>
                                    <option value="Google">Google</option>
                                    <option value="Lenovo">Lenovo</option>
                                    <option value="ASUS">ASUS</option>
                                    <option value="Sony">Sony</option>
                                    <option value="Xiaomi">Xiaomi</option>
                                    <option value="Huawei">Huawei</option>
                                    <option value="OnePlus">OnePlus</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="product-model">–ú–æ–¥–µ–ª—å *:</label>
                                <input type="text" id="product-model" placeholder="iPhone 16 Pro" required>
                            </div>
                            <div class="form-group">
                                <label for="product-sku">SKU (–∞—Ä—Ç–∏–∫—É–ª):</label>
                                <input type="text" id="product-sku" placeholder="–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è">
                                <small style="color: #666;">–û—Å—Ç–∞–≤—å—Ç–µ –ø—É—Å—Ç—ã–º –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏</small>
                            </div>
                        </div>
                        
                        <div>
                            <h4>üí∞ –¶–µ–Ω–∞ –∏ –Ω–∞–ª–∏—á–∏–µ</h4>
                            <div class="form-group">
                                <label for="product-price">–¶–µ–Ω–∞ (—Ä—É–±.) *:</label>
                                <input type="number" id="product-price" step="0.01" placeholder="0.00" required>
                            </div>
                            <div class="form-group">
                                <label for="product-old-price">–°—Ç–∞—Ä–∞—è —Ü–µ–Ω–∞ (—Ä—É–±.):</label>
                                <input type="number" id="product-old-price" step="0.01" placeholder="0.00">
                            </div>
                            <div class="form-group">
                                <label for="product-stock">–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –Ω–∞ —Å–∫–ª–∞–¥–µ:</label>
                                <input type="number" id="product-stock" placeholder="0" min="0">
                            </div>
                            <div class="form-group">
                                <label>
                                    <input type="checkbox" id="product-available" checked> 
                                    –¢–æ–≤–∞—Ä –¥–æ—Å—Ç—É–ø–µ–Ω –¥–ª—è –ø—Ä–æ–¥–∞–∂–∏
                                </label>
                            </div>
                        </div>
                    </div>
                    
                    <div style="margin-bottom: 20px;">
                        <h4>üìù –û–ø–∏—Å–∞–Ω–∏–µ –∏ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏</h4>
                        <div class="form-group">
                            <label for="product-description">–û–ø–∏—Å–∞–Ω–∏–µ:</label>
                            <textarea id="product-description" placeholder="–ü–æ–¥—Ä–æ–±–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞..." rows="3"></textarea>
                        </div>
                        <div class="form-group">
                            <label for="product-specifications">–•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ (JSON):</label>
                            <textarea id="product-specifications" placeholder='{"color": "black", "memory": "128GB", "sim_type": "eSIM"}' rows="4"></textarea>
                            <small style="color: #666;">–í —Ñ–æ—Ä–º–∞—Ç–µ JSON –¥–ª—è —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏—Ö —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫</small>
                        </div>
                    </div>
                    
                    <div style="margin-bottom: 20px;">
                        <h4>üìÇ –ö–∞—Ç–µ–≥–æ—Ä–∏–∏</h4>
                        <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 15px;">
                            <div class="form-group">
                                <label for="product-level0">–û—Å–Ω–æ–≤–Ω–∞—è –∫–∞—Ç–µ–≥–æ—Ä–∏—è *:</label>
                                <select id="product-level0" required>
                                    <option value="">–í—ã–±–µ—Ä–∏—Ç–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—é...</option>
                                    <option value="–°–º–∞—Ä—Ç—Ñ–æ–Ω—ã">–°–º–∞—Ä—Ç—Ñ–æ–Ω—ã</option>
                                    <option value="–ü–ª–∞–Ω—à–µ—Ç—ã">–ü–ª–∞–Ω—à–µ—Ç—ã</option>
                                    <option value="–ù–æ—É—Ç–±—É–∫–∏">–ù–æ—É—Ç–±—É–∫–∏</option>
                                    <option value="–ù–∞—É—à–Ω–∏–∫–∏">–ù–∞—É—à–Ω–∏–∫–∏</option>
                                    <option value="–ê–∫—Å–µ—Å—Å—É–∞—Ä—ã">–ê–∫—Å–µ—Å—Å—É–∞—Ä—ã</option>
                                    <option value="–£–º–Ω—ã–π –¥–æ–º">–£–º–Ω—ã–π –¥–æ–º</option>
                                    <option value="–ò–≥—Ä–æ–≤—ã–µ –ø—Ä–∏—Å—Ç–∞–≤–∫–∏">–ò–≥—Ä–æ–≤—ã–µ –ø—Ä–∏—Å—Ç–∞–≤–∫–∏</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="product-level1">–°–µ—Ä–∏—è:</label>
                                <input type="text" id="product-level1" placeholder="16 Series">
                            </div>
                            <div class="form-group">
                                <label for="product-level2">–ú–æ–¥–µ–ª—å:</label>
                                <input type="text" id="product-level2" placeholder="iPhone 16 Pro">
                            </div>
                        </div>
                    </div>
                    
                    <div style="margin-bottom: 20px;">
                        <h4>üé® –•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ —Ç–æ–≤–∞—Ä–∞</h4>
                        <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 15px;">
                            <div class="form-group">
                                <label for="product-color">–¶–≤–µ—Ç:</label>
                                <input type="text" id="product-color" placeholder="black, white, blue">
                            </div>
                            <div class="form-group">
                                <label for="product-disk">–ü–∞–º—è—Ç—å:</label>
                                <input type="text" id="product-disk" placeholder="128GB, 256GB, 512GB">
                            </div>
                            <div class="form-group">
                                <label for="product-sim">SIM –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è:</label>
                                <input type="text" id="product-sim" placeholder="Single SIM, Dual SIM">
                            </div>
                        </div>
                    </div>
                    
                    <div style="margin-bottom: 20px;">
                        <h4>üñºÔ∏è –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è</h4>
                        <div class="form-group">
                            <label for="product-images">URL –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π (–ø–æ –æ–¥–Ω–æ–º—É –Ω–∞ —Å—Ç—Ä–æ–∫—É):</label>
                            <textarea id="product-images" placeholder="https://example.com/image1.jpg&#10;https://example.com/image2.jpg" rows="3"></textarea>
                            <small style="color: #666;">–ö–∞–∂–¥—ã–π URL —Å –Ω–æ–≤–æ–π —Å—Ç—Ä–æ–∫–∏. –ü–µ—Ä–≤–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –±—É–¥–µ—Ç –æ—Å–Ω–æ–≤–Ω—ã–º.</small>
                        </div>
                    </div>
                    
                    <div style="text-align: center; margin-top: 30px;">
                        <button onclick="addProduct()" class="btn btn-success" style="padding: 12px 30px; font-size: 16px;">
                            ‚ûï –î–æ–±–∞–≤–∏—Ç—å —Ç–æ–≤–∞—Ä
                        </button>
                        <button onclick="loadProducts()" class="btn btn-secondary" style="margin-left: 10px;">
                            ‚Ü©Ô∏è –ù–∞–∑–∞–¥ –∫ —Å–ø–∏—Å–∫—É
                        </button>
                    </div>
                </div>
            `;
        }
        
        function addProduct() {
            // –í–∞–ª–∏–¥–∞—Ü–∏—è –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã—Ö –ø–æ–ª–µ–π
            const name = document.getElementById('product-name').value.trim();
            const brand = document.getElementById('product-brand').value;
            const model = document.getElementById('product-model').value.trim();
            const price = parseFloat(document.getElementById('product-price').value);
            const level0 = document.getElementById('product-level0').value;
            
            if (!name || !brand || !model || isNaN(price) || !level0) {
                alert('‚ùå –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –∑–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è (–æ—Ç–º–µ—á–µ–Ω—ã *)');
                return;
            }
            
            // –°–æ–±–∏—Ä–∞–µ–º –¥–∞–Ω–Ω—ã–µ —Ç–æ–≤–∞—Ä–∞
            const productData = {
                name: name,
                brand: brand,
                model: model,
                description: document.getElementById('product-description').value.trim(),
                price: price,
                old_price: parseFloat(document.getElementById('product-old-price').value) || price,
                stock: parseInt(document.getElementById('product-stock').value) || 0,
                is_available: document.getElementById('product-available').checked,
                sku: document.getElementById('product-sku').value.trim() || `${brand.slice(0,3).toUpperCase()}${Date.now()}`,
                level_0: level0,
                level_1: document.getElementById('product-level1').value.trim(),
                level_2: document.getElementById('product-level2').value.trim(),
                color: document.getElementById('product-color').value.trim(),
                disk: document.getElementById('product-disk').value.trim(),
                sim_config: document.getElementById('product-sim').value.trim()
            };
            
            // –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏
            const specsText = document.getElementById('product-specifications').value.trim();
            if (specsText) {
                try {
                    productData.specifications = JSON.parse(specsText);
                } catch (e) {
                    alert('‚ùå –û—à–∏–±–∫–∞ –≤ —Ñ–æ—Ä–º–∞—Ç–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫ (JSON). –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–∏–Ω—Ç–∞–∫—Å–∏—Å.');
                    return;
                }
            }
            
            // –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
            const imagesText = document.getElementById('product-images').value.trim();
            if (imagesText) {
                const imageUrls = imagesText.split('\n')
                    .map(url => url.trim())
                    .filter(url => url && url.startsWith('http'));
                
                if (imageUrls.length > 0) {
                    // –§–æ—Ä–º–∏—Ä—É–µ–º img_list –≤ –Ω–æ–≤–æ–º —Ñ–æ—Ä–º–∞—Ç–µ
                    productData.img_list = JSON.stringify(imageUrls.map(url => ({ url: url })));
                }
            }
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –∑–∞–≥—Ä—É–∑–∫–∏
            const button = document.querySelector('button[onclick="addProduct()"]');
            const originalText = button.innerHTML;
            button.innerHTML = '‚è≥ –î–æ–±–∞–≤–ª–µ–Ω–∏–µ...';
            button.disabled = true;
            
            // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –∑–∞–ø—Ä–æ—Å
            fetch('/import-single-product', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify(productData)
            })
            .then(response => response.json())
            .then(result => {
                if (result.success) {
                    alert(`‚úÖ –¢–æ–≤–∞—Ä "${result.message}" —É—Å–ø–µ—à–Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω!\nSKU: ${result.sku}\nID: ${result.product_id}`);
                    loadProducts();
                } else {
                    alert(`‚ùå –û—à–∏–±–∫–∞: ${result.detail || result.message}`);
                }
            })
            .catch(error => {
                alert(`‚ùå –û—à–∏–±–∫–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —Ç–æ–≤–∞—Ä–∞: ${error.message}`);
            })
            .finally(() => {
                // –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∫–Ω–æ–ø–∫—É
                button.innerHTML = originalText;
                button.disabled = false;
            });
        }
        
        function loadPriceSKUs() {
            const select = document.getElementById('price-sku');
            select.innerHTML = '<option value="">–í—ã–±–µ—Ä–∏—Ç–µ —Ç–æ–≤–∞—Ä...</option>';
            
               fetch('/all-products')
                .then(response => response.json())
                .then(products => {
                    products.forEach(product => {
                        const option = document.createElement('option');
                        option.value = product.sku;
                        option.textContent = `${product.brand} ${product.model} (${product.sku})`;
                        select.appendChild(option);
                    });
                })
                .catch(error => {
                    console.error('Error loading products for price update:', error);
                });
        }
        
        function updatePrice() {
            const sku = document.getElementById('price-sku').value;
            const newPrice = parseFloat(document.getElementById('new-price').value);
            const oldPrice = parseFloat(document.getElementById('old-price').value);
            
            if (!sku || !newPrice) {
                document.getElementById('price-result').innerHTML = '<p class="status-error">‚ùå –ó–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è</p>';
                return;
            }
            
            const priceData = {
                sku: sku,
                price: newPrice,
                old_price: oldPrice || newPrice
            };
            
            fetch('/update-price', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify(priceData)
            })
            .then(response => response.json())
            .then(result => {
                if (result.message && result.message.includes('—É—Å–ø–µ—à–Ω–æ')) {
                    document.getElementById('price-result').innerHTML = '<p class="status-success">‚úÖ –¶–µ–Ω–∞ —É—Å–ø–µ—à–Ω–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∞!</p>';
                } else {
                    document.getElementById('price-result').innerHTML = `<p class="status-error">‚ùå ${result.detail || result.message}</p>`;
                }
            })
            .catch(error => {
                document.getElementById('price-result').innerHTML = `<p class="status-error">‚ùå –û—à–∏–±–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Ü–µ–Ω—ã: ${error.message}</p>`;
            });
        }
        
        function uploadExcel() {
            const fileInput = document.getElementById('excel-file');
            const file = fileInput.files[0];
            
            if (!file) {
                document.getElementById('upload-result').innerHTML = '<p class="status-error">‚ùå –í—ã–±–µ—Ä–∏—Ç–µ —Ñ–∞–π–ª Excel</p>';
                return;
            }
            
            const formData = new FormData();
            formData.append('file', file);
            
            document.getElementById('upload-result').innerHTML = '<p>–ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–∞–π–ª–∞...</p>';
            
            fetch('/api/excel/import/products', {
                method: 'POST',
                body: formData
            })
            .then(response => response.json())
            .then(result => {
                if (result.message && (result.message.includes('—É—Å–ø–µ—à–Ω–æ') || result.message.includes('–∑–∞–≤–µ—Ä—à–µ–Ω'))) {
                    let messageClass = 'status-success';
                    let icon = '‚úÖ';
                    let mainMessage = '–î–∞–Ω–Ω—ã–µ —É—Å–ø–µ—à–Ω–æ –∑–∞–≥—Ä—É–∂–µ–Ω—ã!';
                    
                    // –ï—Å–ª–∏ –µ—Å—Ç—å –æ—à–∏–±–∫–∏, –º–µ–Ω—è–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ –∏ —Å—Ç–∏–ª—å
                    if (result.errors && result.errors.length > 0) {
                        if (result.added && result.added > 0) {
                            messageClass = 'status-warning';
                            icon = '‚ö†Ô∏è';
                            mainMessage = '–ò–º–ø–æ—Ä—Ç –∑–∞–≤–µ—Ä—à–µ–Ω —Å –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è–º–∏';
                        } else {
                            messageClass = 'status-error';
                            icon = '‚ùå';
                            mainMessage = '–ò–º–ø–æ—Ä—Ç –∑–∞–≤–µ—Ä—à–µ–Ω —Å –æ—à–∏–±–∫–∞–º–∏';
                        }
                    }
                    
                    let fullMessage = `${icon} ${mainMessage}`;
                    if (result.added) {
                        fullMessage += `<br>üì¶ –î–æ–±–∞–≤–ª–µ–Ω–æ —Ç–æ–≤–∞—Ä–æ–≤: ${result.added}`;
                    }
                    if (result.errors && result.errors.length > 0) {
                        fullMessage += `<br>‚ö†Ô∏è –û—à–∏–±–æ–∫: ${result.errors.length}`;
                        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø–µ—Ä–≤—ã–µ –Ω–µ—Å–∫–æ–ª—å–∫–æ –æ—à–∏–±–æ–∫
                        if (result.errors.length <= 3) {
                            fullMessage += '<br><small>';
                            result.errors.forEach(error => {
                                fullMessage += `‚Ä¢ ${error}<br>`;
                            });
                            fullMessage += '</small>';
                        } else {
                            fullMessage += `<br><small>–ü–æ–∫–∞–∑–∞–Ω—ã –ø–µ—Ä–≤—ã–µ 3 –∏–∑ ${result.errors.length} –æ—à–∏–±–æ–∫</small>`;
                        }
                    }
                    
                    document.getElementById('upload-result').innerHTML = `<p class="${messageClass}">${fullMessage}</p>`;
                } else {
                    document.getElementById('upload-result').innerHTML = `<p class="status-error">‚ùå ${result.detail || result.message}</p>`;
                }
            })
            .catch(error => {
                document.getElementById('upload-result').innerHTML = `<p class="status-error">‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏: ${error.message}</p>`;
            });
        }
        
        function uploadPriceExcel() {
            const fileInput = document.getElementById('price-excel-file');
            const file = fileInput.files[0];
            
            if (!file) {
                document.getElementById('price-excel-result').innerHTML = '<p class="status-error">‚ùå –í—ã–±–µ—Ä–∏—Ç–µ —Ñ–∞–π–ª Excel —Å —Ü–µ–Ω–∞–º–∏</p>';
                return;
            }
            
            const formData = new FormData();
            formData.append('file', file);
            
            document.getElementById('price-excel-result').innerHTML = '<p>üìä –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ü–µ–Ω...</p>';
            
            fetch('/import-prices', {
                method: 'POST',
                body: formData
            })
            .then(response => response.json())
            .then(result => {
                let html = '<div class="status-success">';
                html += `‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ü–µ–Ω –∑–∞–≤–µ—Ä—à–µ–Ω–æ!<br>`;
                html += `<strong>–û–±—Ä–∞–±–æ—Ç–∞–Ω–æ:</strong> ${result.total_processed || 0} —Å—Ç—Ä–æ–∫<br>`;
                html += `<strong>–û–±–Ω–æ–≤–ª–µ–Ω–æ:</strong> ${result.updated || 0} —Ü–µ–Ω<br>`;
                
                if (result.not_found && result.not_found.length > 0) {
                    html += `<br><strong>‚ö†Ô∏è –ù–µ –Ω–∞–π–¥–µ–Ω—ã —Ç–æ–≤–∞—Ä—ã:</strong><br>`;
                    result.not_found.forEach(item => {
                        html += `‚Ä¢ ${item}<br>`;
                    });
                }
                
                if (result.errors && result.errors.length > 0) {
                    html += `<br><strong>‚ùå –û—à–∏–±–∫–∏:</strong><br>`;
                    result.errors.forEach(error => {
                        html += `‚Ä¢ ${error}<br>`;
                    });
                }
                
                html += '</div>';
                document.getElementById('price-excel-result').innerHTML = html;
            })
            .catch(error => {
                document.getElementById('price-excel-result').innerHTML = `<p class="status-error">‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏: ${error.message}</p>`;
            });
        }
        
        function uploadImagesExcel() {
            const fileInput = document.getElementById('images-excel-file');
            const file = fileInput.files[0];
            
            if (!file) {
                document.getElementById('images-excel-result').innerHTML = '<p class="status-error">‚ùå –í—ã–±–µ—Ä–∏—Ç–µ —Ñ–∞–π–ª Excel —Å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º–∏</p>';
                return;
            }
            
            const formData = new FormData();
            formData.append('file', file);
            
            document.getElementById('images-excel-result').innerHTML = '<p>üñºÔ∏è –û–±—Ä–∞–±–æ—Ç–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π...</p>';
            
            fetch('/api/excel/import/images', {
                method: 'POST',
                body: formData
            })
            .then(response => response.json())
            .then(result => {
                let html = '<div class="status-success">';
                html += `‚úÖ –ó–∞–≥—Ä—É–∑–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –∑–∞–≤–µ—Ä—à–µ–Ω–∞!<br>`;
                html += `<strong>–û–±—Ä–∞–±–æ—Ç–∞–Ω–æ:</strong> ${result.total_processed || 0} –∑–∞–ø–∏—Å–µ–π<br>`;
                html += `<strong>–î–æ–±–∞–≤–ª–µ–Ω–æ:</strong> ${result.added || 0} –Ω–æ–≤—ã—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π<br>`;
                html += `<strong>–û–±–Ω–æ–≤–ª–µ–Ω–æ:</strong> ${result.updated || 0} —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π<br>`;
                
                if (result.errors && result.errors.length > 0) {
                    html += `<br><strong>‚ùå –û—à–∏–±–∫–∏:</strong><br>`;
                    result.errors.forEach(error => {
                        html += `‚Ä¢ ${error}<br>`;
                    });
                }
                
                html += '</div>';
                document.getElementById('images-excel-result').innerHTML = html;
            })
            .catch(error => {
                document.getElementById('images-excel-result').innerHTML = `<p class="status-error">‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏: ${error.message}</p>`;
            });
        }
        
        function openManualPriceManager() {
            window.open('http://localhost:8000/webapp', '_blank');
        }
        
        function showEditProductForm(productId) {
            // –ü–æ–ª—É—á–∞–µ–º –¥–∞–Ω–Ω—ã–µ —Ç–æ–≤–∞—Ä–∞
            fetch('/all-products')
                .then(response => response.json())
                .then(products => {
                    const product = products.find(p => p.id === productId);
                    if (!product) {
                        alert('‚ùå –¢–æ–≤–∞—Ä –Ω–µ –Ω–∞–π–¥–µ–Ω');
                        return;
                    }
                    
                    const content = document.getElementById('products-content');
                    content.innerHTML = `
                        <div class="product-card">
                            <h3>‚úèÔ∏è –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å —Ç–æ–≤–∞—Ä</h3>
                            <form id="editProductForm" onsubmit="updateProduct(event, ${productId})">
                                <div class="form-group">
                                    <label>–ù–∞–∑–≤–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞*</label>
                                    <input type="text" id="edit_name" value="${product.name || ''}" required>
                                </div>
                                
                                <div class="form-group">
                                    <label>–û–ø–∏—Å–∞–Ω–∏–µ</label>
                                    <textarea id="edit_description" rows="3">${product.description || ''}</textarea>
                                </div>
                                
                                <div class="form-group">
                                    <label>–ë—Ä–µ–Ω–¥</label>
                                    <input type="text" id="edit_brand" value="${product.brand || ''}">
                                </div>
                                
                                <div class="form-group">
                                    <label>–ú–æ–¥–µ–ª—å</label>
                                    <input type="text" id="edit_model" value="${product.model || ''}">
                                </div>
                                
                                <div class="form-group">
                                    <label>–û—Å–Ω–æ–≤–Ω–∞—è –∫–∞—Ç–µ–≥–æ—Ä–∏—è (level0)*</label>
                                    <input type="text" id="edit_level_0" value="${product.level_0 || ''}" required>
                                </div>
                                
                                <div class="form-group">
                                    <label>–ü–æ–¥–∫–∞—Ç–µ–≥–æ—Ä–∏—è (level1)</label>
                                    <input type="text" id="edit_level_1" value="${product.level_1 || ''}">
                                </div>
                                
                                <div class="form-group">
                                    <label>–î–µ—Ç–∞–ª—å–Ω–∞—è –∫–∞—Ç–µ–≥–æ—Ä–∏—è (level2)</label>
                                    <input type="text" id="edit_level_2" value="${product.level_2 || ''}">
                                </div>
                                
                                <div class="form-group">
                                    <label>–¶–≤–µ—Ç</label>
                                    <input type="text" id="edit_color" value="${product.color || ''}">
                                </div>
                                
                                <div class="form-group">
                                    <label>–ü–∞–º—è—Ç—å (disk)</label>
                                    <input type="text" id="edit_disk" value="${product.disk || ''}">
                                </div>
                                
                                <div class="form-group">
                                    <label>SIM –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è</label>
                                    <input type="text" id="edit_sim_config" value="${product.sim_config || ''}">
                                </div>
                                
                                <div class="form-group">
                                    <label>–¶–µ–Ω–∞*</label>
                                    <input type="number" id="edit_price" value="${product.price || 0}" step="0.01" required>
                                </div>
                                
                                <div class="form-group">
                                    <label>–°—Ç–∞—Ä–∞—è —Ü–µ–Ω–∞</label>
                                    <input type="number" id="edit_old_price" value="${product.old_price || ''}" step="0.01">
                                </div>
                                
                                <div class="form-group">
                                    <label>–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –Ω–∞ —Å–∫–ª–∞–¥–µ</label>
                                    <input type="number" id="edit_stock" value="${product.stock || 0}">
                                </div>
                                
                                <div class="form-group">
                                    <label>
                                        <input type="checkbox" id="edit_is_available" ${product.is_available ? 'checked' : ''}>
                                        –î–æ—Å—Ç—É–ø–µ–Ω –¥–ª—è –ø—Ä–æ–¥–∞–∂–∏
                                    </label>
                                </div>
                                
                                <div class="form-group">
                                    <label>URL –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π (–ø–æ –æ–¥–Ω–æ–º—É –Ω–∞ —Å—Ç—Ä–æ–∫—É)</label>
                                    <textarea id="edit_image_urls" rows="4">${product.image_urls || ''}</textarea>
                                </div>
                                
                                <div style="display: flex; gap: 10px; margin-top: 20px;">
                                    <button type="submit" class="btn btn-success" style="flex: 1;">üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è</button>
                                    <button type="button" onclick="loadProducts()" class="btn btn-secondary" style="flex: 1;">‚ùå –û—Ç–º–µ–Ω–∞</button>
                                </div>
                            </form>
                        </div>
                    `;
                })
                .catch(error => {
                    alert(`‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö —Ç–æ–≤–∞—Ä–∞: ${error.message}`);
                });
        }
        
        function updateProduct(event, productId) {
            event.preventDefault();
            
            const productData = {
                name: document.getElementById('edit_name').value,
                description: document.getElementById('edit_description').value,
                brand: document.getElementById('edit_brand').value,
                model: document.getElementById('edit_model').value,
                level_0: document.getElementById('edit_level_0').value,
                level_1: document.getElementById('edit_level_1').value,
                level_2: document.getElementById('edit_level_2').value,
                color: document.getElementById('edit_color').value,
                disk: document.getElementById('edit_disk').value,
                sim_config: document.getElementById('edit_sim_config').value,
                price: parseFloat(document.getElementById('edit_price').value),
                old_price: document.getElementById('edit_old_price').value ? parseFloat(document.getElementById('edit_old_price').value) : null,
                stock: parseInt(document.getElementById('edit_stock').value),
                is_available: document.getElementById('edit_is_available').checked,
                image_urls: document.getElementById('edit_image_urls').value
            };
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –∑–∞–≥—Ä—É–∑–∫–∏
            const submitBtn = event.target.querySelector('button[type="submit"]');
            submitBtn.disabled = true;
            submitBtn.textContent = '‚è≥ –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ...';
            
            // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –∑–∞–ø—Ä–æ—Å –Ω–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ
            fetch(`/products/${productId}`, {
                method: 'PUT',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify(productData)
            })
            .then(response => response.json())
            .then(result => {
                if (result.success) {
                    alert(`‚úÖ ${result.message}`);
                    // –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∂–∞–µ–º —Å–ø–∏—Å–æ–∫ —Ç–æ–≤–∞—Ä–æ–≤
                    loadProducts();
                } else {
                    alert(`‚ùå –û—à–∏–±–∫–∞: ${result.detail || result.message}`);
                    submitBtn.disabled = false;
                    submitBtn.textContent = 'üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è';
                }
            })
            .catch(error => {
                alert(`‚ùå –û—à–∏–±–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Ç–æ–≤–∞—Ä–∞: ${error.message}`);
                submitBtn.disabled = false;
                submitBtn.textContent = 'üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è';
            });
        }

        function deleteProduct(productId, productName) {
            // –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ —É–¥–∞–ª–µ–Ω–∏—è
            if (!confirm(`–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å —Ç–æ–≤–∞—Ä "${productName}"?\n\n–≠—Ç–æ –¥–µ–π—Å—Ç–≤–∏–µ –Ω–µ–æ–±—Ä–∞—Ç–∏–º–æ!`)) {
                return;
            }
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –∑–∞–≥—Ä—É–∑–∫–∏
            const content = document.getElementById('products-content');
            const originalContent = content.innerHTML;
            
            // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –∑–∞–ø—Ä–æ—Å –Ω–∞ —É–¥–∞–ª–µ–Ω–∏–µ
            fetch(`/products/${productId}`, {
                method: 'DELETE'
            })
            .then(response => response.json())
            .then(result => {
                if (result.success) {
                    alert(`‚úÖ ${result.message}`);
                    // –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∂–∞–µ–º —Å–ø–∏—Å–æ–∫ —Ç–æ–≤–∞—Ä–æ–≤
                    loadProducts();
                } else {
                    alert(`‚ùå –û—à–∏–±–∫–∞: ${result.detail || result.message}`);
                    content.innerHTML = originalContent;
                }
            })
            .catch(error => {
                alert(`‚ùå –û—à–∏–±–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è —Ç–æ–≤–∞—Ä–∞: ${error.message}`);
                content.innerHTML = originalContent;
            });
        }
        
        function downloadCurrentProducts() {
            // –°–∫–∞—á–∞—Ç—å —Ç–µ–∫—É—â–∏–µ —Ç–æ–≤–∞—Ä—ã –≤ Excel
            window.location.href = '/api/excel/export/products';
        }
        
        function showUploadProductsForm() {
            const content = document.getElementById('products-content');
            content.innerHTML = `
                <div class="product-card">
                    <h3>üì§ –ú–∞—Å—Å–æ–≤–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ/–¥–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–æ–≤ —á–µ—Ä–µ–∑ Excel</h3>
                    <div style="background: #f8f9fa; padding: 15px; border-radius: 8px; margin-bottom: 20px;">
                        <p><strong>üí° –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç:</strong></p>
                        <ul style="margin-left: 20px;">
                            <li>–ï—Å–ª–∏ <strong>SKU —Å—É—â–µ—Å—Ç–≤—É–µ—Ç</strong> ‚Üí —Ç–æ–≤–∞—Ä –±—É–¥–µ—Ç <strong>–æ–±–Ω–æ–≤–ª–µ–Ω</strong></li>
                            <li>–ï—Å–ª–∏ <strong>SKU –Ω–æ–≤—ã–π</strong> ‚Üí —Ç–æ–≤–∞—Ä –±—É–¥–µ—Ç <strong>–¥–æ–±–∞–≤–ª–µ–Ω</strong></li>
                            <li>SKU –º–æ–∂–Ω–æ –æ—Å—Ç–∞–≤–∏—Ç—å –ø—É—Å—Ç—ã–º - —Å–∏—Å—Ç–µ–º–∞ —Å–≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏</li>
                        </ul>
                        <p style="margin-top: 10px;"><strong>üì• –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è:</strong></p>
                        <ol style="margin-left: 20px;">
                            <li>–ù–∞–∂–º–∏—Ç–µ "–°–∫–∞—á–∞—Ç—å —Ç–µ–∫—É—â–∏–µ —Ç–æ–≤–∞—Ä—ã" —á—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å Excel —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º–∏ —Ç–æ–≤–∞—Ä–∞–º–∏</li>
                            <li>–û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ –Ω—É–∂–Ω—ã–µ —Å—Ç—Ä–æ–∫–∏ –∏–ª–∏ –¥–æ–±–∞–≤—å—Ç–µ –Ω–æ–≤—ã–µ</li>
                            <li>–ó–∞–≥—Ä—É–∑–∏—Ç–µ —Ñ–∞–π–ª –æ–±—Ä–∞—Ç–Ω–æ</li>
                        </ol>
                    </div>
                    <form id="uploadProductsForm" onsubmit="uploadAndUpdateProducts(event)">
                        <div class="form-group">
                            <label>–í—ã–±–µ—Ä–∏—Ç–µ Excel —Ñ–∞–π–ª</label>
                            <input type="file" id="products-excel-file" accept=".xlsx,.xls" required>
                        </div>
                        <div style="display: flex; gap: 10px; margin-top: 20px;">
                            <button type="submit" class="btn btn-success" style="flex: 1;">üì§ –ó–∞–≥—Ä—É–∑–∏—Ç—å –∏ –æ–±–Ω–æ–≤–∏—Ç—å</button>
                            <button type="button" onclick="loadProducts()" class="btn btn-secondary" style="flex: 1;">‚ùå –û—Ç–º–µ–Ω–∞</button>
                        </div>
                    </form>
                    <div id="upload-products-result" style="margin-top: 20px;"></div>
                </div>
            `;
        }
        
        function uploadAndUpdateProducts(event) {
            event.preventDefault();
            
            const fileInput = document.getElementById('products-excel-file');
            const file = fileInput.files[0];
            
            if (!file) {
                alert('‚ùå –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤—ã–±–µ—Ä–∏—Ç–µ —Ñ–∞–π–ª');
                return;
            }
            
            const formData = new FormData();
            formData.append('file', file);
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –∑–∞–≥—Ä—É–∑–∫–∏
            document.getElementById('upload-products-result').innerHTML = '<p>‚è≥ –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ñ–∞–π–ª–∞...</p>';
            
            fetch('/api/excel/update-or-create/products', {
                method: 'POST',
                body: formData
            })
            .then(response => response.json())
            .then(result => {
                let html = '<div style="padding: 15px; border-radius: 8px; background: #f8f9fa;">';
                
                if (result.success) {
                    html += `<p class="status-success">‚úÖ ${result.message}</p>`;
                    html += `<p><strong>üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:</strong></p>`;
                    html += `<ul style="margin-left: 20px;">`;
                    html += `<li>‚ûï –î–æ–±–∞–≤–ª–µ–Ω–æ –Ω–æ–≤—ã—Ö —Ç–æ–≤–∞—Ä–æ–≤: <strong>${result.added}</strong></li>`;
                    html += `<li>‚úèÔ∏è –û–±–Ω–æ–≤–ª–µ–Ω–æ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö: <strong>${result.updated}</strong></li>`;
                    html += `<li>üìù –í—Å–µ–≥–æ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–æ: <strong>${result.total_processed}</strong></li>`;
                    
                    // –î–æ–±–∞–≤–ª—è–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ–± –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è—Ö –µ—Å–ª–∏ –µ—Å—Ç—å
                    if (result.images_added !== undefined || result.images_updated !== undefined) {
                        html += `<li>üñºÔ∏è –î–æ–±–∞–≤–ª–µ–Ω–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π: <strong>${result.images_added || 0}</strong></li>`;
                        html += `<li>üñºÔ∏è –û–±–Ω–æ–≤–ª–µ–Ω–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π: <strong>${result.images_updated || 0}</strong></li>`;
                    }
                    
                    html += `</ul>`;
                    
                    if (result.errors && result.errors.length > 0) {
                        html += `<br><strong>‚ö†Ô∏è –û—à–∏–±–∫–∏ —Ç–æ–≤–∞—Ä–æ–≤ (${result.errors.length}):</strong><br>`;
                        html += `<div style="max-height: 200px; overflow-y: auto; background: white; padding: 10px; border-radius: 5px;">`;
                        result.errors.forEach(error => {
                            html += `‚Ä¢ ${error}<br>`;
                        });
                        html += '</div>';
                    }
                    
                    // –î–æ–±–∞–≤–ª—è–µ–º –æ—à–∏–±–∫–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –µ—Å–ª–∏ –µ—Å—Ç—å
                    if (result.images_errors && result.images_errors.length > 0) {
                        html += `<br><strong>‚ö†Ô∏è –û—à–∏–±–∫–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π (${result.images_errors.length}):</strong><br>`;
                        html += `<div style="max-height: 200px; overflow-y: auto; background: white; padding: 10px; border-radius: 5px;">`;
                        result.images_errors.forEach(error => {
                            html += `‚Ä¢ ${error}<br>`;
                        });
                        html += '</div>';
                    }
                    
                    html += '<br><button onclick="loadProducts()" class="btn btn-primary">üîÑ –û–±–Ω–æ–≤–∏—Ç—å —Å–ø–∏—Å–æ–∫ —Ç–æ–≤–∞—Ä–æ–≤</button>';
                } else {
                    html += `<p class="status-error">‚ùå –û—à–∏–±–∫–∞: ${result.detail || result.message}</p>`;
                }
                
                html += '</div>';
                document.getElementById('upload-products-result').innerHTML = html;
            })
            .catch(error => {
                document.getElementById('upload-products-result').innerHTML = `<p class="status-error">‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏: ${error.message}</p>`;
            });
        }
        
        function loadCategories() {
            const content = document.getElementById('categories-content');
            content.innerHTML = '<p>–ó–∞–≥—Ä—É–∑–∫–∞ –∫–∞—Ç–µ–≥–æ—Ä–∏–π...</p>';
            
            fetch('/categories')
                .then(response => response.json())
                .then(categories => {
                    let html = `<div class="product-grid">`;
                    categories.forEach(category => {
                        html += `
                            <div class="product-card">
                                <h3>${category.name}</h3>
                                <p><strong>ID:</strong> ${category.id}</p>
                                <p><strong>–£—Ä–æ–≤–µ–Ω—å 0:</strong> ${category.level_0}</p>
                                <p><strong>–£—Ä–æ–≤–µ–Ω—å 1:</strong> ${category.level_1 || '–ù–µ —É–∫–∞–∑–∞–Ω'}</p>
                                <p><strong>–£—Ä–æ–≤–µ–Ω—å 2:</strong> ${category.level_2 || '–ù–µ —É–∫–∞–∑–∞–Ω'}</p>
                                <p><strong>–û–ø–∏—Å–∞–Ω–∏–µ:</strong> ${category.description || '–ù–µ—Ç –æ–ø–∏—Å–∞–Ω–∏—è'}</p>
                                <p><strong>–ò–∫–æ–Ω–∫–∞:</strong> ${category.icon || '–ù–µ—Ç –∏–∫–æ–Ω–∫–∏'}</p>
                                <p><strong>–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç–æ–≤–∞—Ä–æ–≤:</strong> ${category.product_count || 0}</p>
                            </div>
                        `;
                    });
                    html += `</div>`;
                    content.innerHTML = html;
                })
                .catch(error => {
                    content.innerHTML = `<p class="status-error">‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–π: ${error.message}</p>`;
                });
        }
        
        function showAddCategoryForm() {
            const content = document.getElementById('categories-content');
            content.innerHTML = `
                <div class="product-card">
                    <h3>‚ûï –î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—É—é –∫–∞—Ç–µ–≥–æ—Ä–∏—é</h3>
                    
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 20px;">
                        <div>
                            <h4>üìã –û—Å–Ω–æ–≤–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</h4>
                            <div class="form-group">
                                <label for="category-level0">–û—Å–Ω–æ–≤–Ω–∞—è –∫–∞—Ç–µ–≥–æ—Ä–∏—è *:</label>
                                <input type="text" id="category-level0" placeholder="–°–º–∞—Ä—Ç—Ñ–æ–Ω—ã" required>
                            </div>
                            <div class="form-group">
                                <label for="category-level1">–°–µ—Ä–∏—è:</label>
                                <input type="text" id="category-level1" placeholder="16 Series">
                            </div>
                            <div class="form-group">
                                <label for="category-level2">–ú–æ–¥–µ–ª—å:</label>
                                <input type="text" id="category-level2" placeholder="iPhone 16 Pro">
                            </div>
                        </div>
                        
                        <div>
                            <h4>üìù –û–ø–∏—Å–∞–Ω–∏–µ –∏ –∏–∫–æ–Ω–∫–∞</h4>
                            <div class="form-group">
                                <label for="category-description">–û–ø–∏—Å–∞–Ω–∏–µ:</label>
                                <textarea id="category-description" placeholder="–û–ø–∏—Å–∞–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏..." rows="3"></textarea>
                            </div>
                            <div class="form-group">
                                <label for="category-icon">–ò–∫–æ–Ω–∫–∞ (—ç–º–æ–¥–∑–∏):</label>
                                <input type="text" id="category-icon" placeholder="üì±" maxlength="2">
                            </div>
                        </div>
                    </div>
                    
                    <div style="text-align: center; margin-top: 30px;">
                        <button onclick="addCategory()" class="btn btn-success" style="padding: 12px 30px; font-size: 16px;">
                            ‚ûï –î–æ–±–∞–≤–∏—Ç—å –∫–∞—Ç–µ–≥–æ—Ä–∏—é
                        </button>
                        <button onclick="loadCategories()" class="btn btn-secondary" style="margin-left: 10px;">
                            ‚Ü©Ô∏è –ù–∞–∑–∞–¥ –∫ —Å–ø–∏—Å–∫—É
                        </button>
                    </div>
                </div>
            `;
        }
        
        function addCategory() {
            const level0 = document.getElementById('category-level0').value.trim();
            const level1 = document.getElementById('category-level1').value.trim();
            const level2 = document.getElementById('category-level2').value.trim();
            const description = document.getElementById('category-description').value.trim();
            const icon = document.getElementById('category-icon').value.trim();
            
            if (!level0) {
                alert('‚ùå –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –∑–∞–ø–æ–ª–Ω–∏—Ç–µ –æ—Å–Ω–æ–≤–Ω—É—é –∫–∞—Ç–µ–≥–æ—Ä–∏—é');
                return;
            }
            
            const categoryData = {
                level_0: level0,
                level_1: level1 || null,
                level_2: level2 || null,
                description: description || null,
                icon: icon || null
            };
            
            const button = document.querySelector('button[onclick="addCategory()"]');
            const originalText = button.innerHTML;
            button.innerHTML = '‚è≥ –î–æ–±–∞–≤–ª–µ–Ω–∏–µ...';
            button.disabled = true;
            
            fetch('/api/categories', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify(categoryData)
            })
            .then(response => response.json())
            .then(result => {
                if (result.success) {
                    alert(`‚úÖ –ö–∞—Ç–µ–≥–æ—Ä–∏—è "${level0}" —É—Å–ø–µ—à–Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω–∞!`);
                    loadCategories();
                } else {
                    alert(`‚ùå –û—à–∏–±–∫–∞: ${result.detail || result.message}`);
                }
            })
            .catch(error => {
                alert(`‚ùå –û—à–∏–±–∫–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –∫–∞—Ç–µ–≥–æ—Ä–∏–∏: ${error.message}`);
            })
            .finally(() => {
                button.innerHTML = originalText;
                button.disabled = false;
            });
        }
        
        // Load price SKUs when prices section is selected
        document.getElementById('price-sku').addEventListener('focus', loadPriceSKUs);
        
        // Load stats on page load
        document.addEventListener('DOMContentLoaded', loadStats);
    </script>
    <!-- Admin panel updated: 2024-01-20 15:30:00 -->
</body>
</html>
